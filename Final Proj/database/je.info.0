2015-05-03 18:44:11.350 UTC SEVERE [/home/cis455/workspace/CIS555/Final Proj/database] of persist#QueueStore#edu.upenn.cis455.storage.URLQ
com.sleepycat.je.ThreadInterruptedException: (JE 6.2.31) Environment must be closed, caused by: com.sleepycat.je.ThreadInterruptedException: Environment invalid because of previous exception: (JE 6.2.31) /home/cis455/workspace/CIS555/Final Proj/database java.lang.InterruptedException THREAD_INTERRUPTED: InterruptedException may cause incorrect internal state, unable to continue. Environment is invalid and must be closed.
	at com.sleepycat.je.ThreadInterruptedException.wrapSelf(ThreadInterruptedException.java:99)
	at com.sleepycat.je.dbi.EnvironmentImpl.checkIfInvalid(EnvironmentImpl.java:1626)
	at com.sleepycat.je.log.LogManager.serialLog(LogManager.java:441)
	at com.sleepycat.je.log.LogManager.logItem(LogManager.java:403)
	at com.sleepycat.je.log.LogManager.log(LogManager.java:314)
	at com.sleepycat.je.tree.LN.logInternal(LN.java:600)
	at com.sleepycat.je.tree.LN.log(LN.java:411)
	at com.sleepycat.je.tree.BIN.logDirtyLN(BIN.java:1312)
	at com.sleepycat.je.tree.BIN.logDirtyChildren(BIN.java:1268)
	at com.sleepycat.je.recovery.Checkpointer.logSiblings(Checkpointer.java:1495)
	at com.sleepycat.je.recovery.Checkpointer.flushIN(Checkpointer.java:1243)
	at com.sleepycat.je.recovery.Checkpointer.flushIN(Checkpointer.java:1369)
	at com.sleepycat.je.recovery.Checkpointer.flushDirtyNodes(Checkpointer.java:1003)
	at com.sleepycat.je.recovery.Checkpointer.syncDatabase(Checkpointer.java:908)
	at com.sleepycat.je.dbi.DatabaseImpl.sync(DatabaseImpl.java:1434)
	at com.sleepycat.je.dbi.DatabaseImpl.handleClosed(DatabaseImpl.java:1302)
	at com.sleepycat.je.Database.closeInternalWork(Database.java:651)
	at com.sleepycat.je.Database.closeInternal(Database.java:518)
	at com.sleepycat.je.Database.close(Database.java:438)
	at com.sleepycat.persist.impl.Store.closeDb(Store.java:1544)
	at com.sleepycat.persist.impl.Store.close(Store.java:1143)
	at com.sleepycat.persist.EntityStore.close(EntityStore.java:667)
	at edu.upenn.cis455.storage.URLQueueDA.close(URLQueueDA.java:116)
	at edu.upenn.cis455.storage.DBWrapper.closeDBs(DBWrapper.java:46)
	at edu.upenn.cis455.crawler.CrawlerWorkerPool.shutdown(CrawlerWorkerPool.java:74)
	at edu.upenn.cis455.servlet.CrawlerServlet.doGet(CrawlerServlet.java:132)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:618)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:725)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:291)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:501)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)
	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:610)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:516)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1086)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:659)
	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1558)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1515)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.sleepycat.je.ThreadInterruptedException: Environment invalid because of previous exception: (JE 6.2.31) /home/cis455/workspace/CIS555/Final Proj/database java.lang.InterruptedException THREAD_INTERRUPTED: InterruptedException may cause incorrect internal state, unable to continue. Environment is invalid and must be closed.
	at com.sleepycat.je.latch.SharedLatchImpl.acquireShared(SharedLatchImpl.java:102)
	at com.sleepycat.je.tree.Tree.getRootINInternal(Tree.java:436)
	at com.sleepycat.je.tree.Tree.getRootIN(Tree.java:420)
	at com.sleepycat.je.tree.Tree.search(Tree.java:2233)
	at com.sleepycat.je.tree.Tree.search(Tree.java:2200)
	at com.sleepycat.je.dbi.CursorImpl.searchExact(CursorImpl.java:1773)
	at com.sleepycat.je.Cursor.searchExact(Cursor.java:3630)
	at com.sleepycat.je.Cursor.searchNoDups(Cursor.java:3495)
	at com.sleepycat.je.Cursor.search(Cursor.java:3316)
	at com.sleepycat.je.Database.get(Database.java:1400)
	at com.sleepycat.persist.BasicIndex.contains(BasicIndex.java:95)
	at com.sleepycat.persist.PrimaryIndex.contains(PrimaryIndex.java:208)
	at com.sleepycat.persist.BasicIndex.contains(BasicIndex.java:85)
	at com.sleepycat.persist.PrimaryIndex.contains(PrimaryIndex.java:208)
	at edu.upenn.cis455.storage.URLVisitedDA.containsEntry(URLVisitedDA.java:51)
	at edu.upenn.cis455.crawler.CrawlerWorker.extractURL(CrawlerWorker.java:335)
	at edu.upenn.cis455.crawler.CrawlerWorker.crawlPage(CrawlerWorker.java:301)
	at edu.upenn.cis455.crawler.CrawlerWorker.run(CrawlerWorker.java:126)
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1325)
	at java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.tryLock(ReentrantReadWriteLock.java:873)
	at com.sleepycat.je.latch.SharedLatchImpl.acquireShared(SharedLatchImpl.java:97)
	... 17 more

2015-05-03 18:46:25.880 UTC SEVERE [/home/cis455/workspace/CIS555/Final Proj/database] of persist#QueueStore#edu.upenn.cis455.storage.URLQ
com.sleepycat.je.ThreadInterruptedException: (JE 6.2.31) Environment must be closed, caused by: com.sleepycat.je.ThreadInterruptedException: Environment invalid because of previous exception: (JE 6.2.31) /home/cis455/workspace/CIS555/Final Proj/database java.lang.InterruptedException THREAD_INTERRUPTED: InterruptedException may cause incorrect internal state, unable to continue. Environment is invalid and must be closed.
	at com.sleepycat.je.ThreadInterruptedException.wrapSelf(ThreadInterruptedException.java:99)
	at com.sleepycat.je.dbi.EnvironmentImpl.checkIfInvalid(EnvironmentImpl.java:1626)
	at com.sleepycat.je.log.LogManager.serialLog(LogManager.java:441)
	at com.sleepycat.je.log.LogManager.logItem(LogManager.java:403)
	at com.sleepycat.je.log.LogManager.log(LogManager.java:314)
	at com.sleepycat.je.tree.LN.logInternal(LN.java:600)
	at com.sleepycat.je.tree.LN.log(LN.java:411)
	at com.sleepycat.je.tree.BIN.logDirtyLN(BIN.java:1312)
	at com.sleepycat.je.tree.BIN.logDirtyChildren(BIN.java:1268)
	at com.sleepycat.je.recovery.Checkpointer.logSiblings(Checkpointer.java:1495)
	at com.sleepycat.je.recovery.Checkpointer.flushIN(Checkpointer.java:1243)
	at com.sleepycat.je.recovery.Checkpointer.flushDirtyNodes(Checkpointer.java:1003)
	at com.sleepycat.je.recovery.Checkpointer.syncDatabase(Checkpointer.java:908)
	at com.sleepycat.je.dbi.DatabaseImpl.sync(DatabaseImpl.java:1434)
	at com.sleepycat.je.dbi.DatabaseImpl.handleClosed(DatabaseImpl.java:1302)
	at com.sleepycat.je.Database.closeInternalWork(Database.java:651)
	at com.sleepycat.je.Database.closeInternal(Database.java:518)
	at com.sleepycat.je.Database.close(Database.java:438)
	at com.sleepycat.persist.impl.Store.closeDb(Store.java:1544)
	at com.sleepycat.persist.impl.Store.close(Store.java:1143)
	at com.sleepycat.persist.EntityStore.close(EntityStore.java:667)
	at edu.upenn.cis455.storage.URLQueueDA.close(URLQueueDA.java:116)
	at edu.upenn.cis455.storage.DBWrapper.closeDBs(DBWrapper.java:46)
	at edu.upenn.cis455.crawler.CrawlerWorkerPool.shutdown(CrawlerWorkerPool.java:74)
	at edu.upenn.cis455.servlet.CrawlerServlet.doGet(CrawlerServlet.java:132)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:618)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:725)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:291)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:501)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)
	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:610)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:516)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1086)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:659)
	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1558)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1515)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.sleepycat.je.ThreadInterruptedException: Environment invalid because of previous exception: (JE 6.2.31) /home/cis455/workspace/CIS555/Final Proj/database java.lang.InterruptedException THREAD_INTERRUPTED: InterruptedException may cause incorrect internal state, unable to continue. Environment is invalid and must be closed.
	at com.sleepycat.je.latch.LatchImpl.acquireExclusive(LatchImpl.java:60)
	at com.sleepycat.je.tree.IN.latch(IN.java:480)
	at com.sleepycat.je.tree.IN.latch(IN.java:490)
	at com.sleepycat.je.dbi.DiskOrderedScanner.processBIN(DiskOrderedScanner.java:601)
	at com.sleepycat.je.dbi.DiskOrderedScanner.fetchAndProcessBINs(DiskOrderedScanner.java:554)
	at com.sleepycat.je.dbi.DiskOrderedScanner.scan(DiskOrderedScanner.java:286)
	at com.sleepycat.je.dbi.DatabaseImpl.count(DatabaseImpl.java:2263)
	at com.sleepycat.je.Database.count(Database.java:1957)
	at com.sleepycat.compat.DbCompat.getDatabaseCount(DbCompat.java:252)
	at com.sleepycat.persist.BasicIndex.count(BasicIndex.java:103)
	at com.sleepycat.persist.PrimaryIndex.count(PrimaryIndex.java:208)
	at edu.upenn.cis455.storage.URLQueueDA.pushURL(URLQueueDA.java:52)
	at edu.upenn.cis455.crawler.CrawlerWorker.extractURL(CrawlerWorker.java:336)
	at edu.upenn.cis455.crawler.CrawlerWorker.crawlPage(CrawlerWorker.java:301)
	at edu.upenn.cis455.crawler.CrawlerWorker.run(CrawlerWorker.java:126)
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireNanos(AbstractQueuedSynchronizer.java:1244)
	at java.util.concurrent.locks.ReentrantLock.tryLock(ReentrantLock.java:445)
	at com.sleepycat.je.latch.LatchImpl.acquireExclusive(LatchImpl.java:55)
	... 14 more

2015-05-03 18:50:01.491 UTC SEVERE [/home/cis455/workspace/CIS555/Final Proj/database] of persist#QueueStore#edu.upenn.cis455.storage.URLQ
com.sleepycat.je.ThreadInterruptedException: (JE 6.2.31) Environment must be closed, caused by: com.sleepycat.je.ThreadInterruptedException: Environment invalid because of previous exception: (JE 6.2.31) /home/cis455/workspace/CIS555/Final Proj/database java.lang.InterruptedException THREAD_INTERRUPTED: InterruptedException may cause incorrect internal state, unable to continue. Environment is invalid and must be closed.
	at com.sleepycat.je.ThreadInterruptedException.wrapSelf(ThreadInterruptedException.java:99)
	at com.sleepycat.je.dbi.EnvironmentImpl.checkIfInvalid(EnvironmentImpl.java:1626)
	at com.sleepycat.je.log.LogManager.serialLog(LogManager.java:441)
	at com.sleepycat.je.log.LogManager.logItem(LogManager.java:403)
	at com.sleepycat.je.log.LogManager.log(LogManager.java:314)
	at com.sleepycat.je.tree.LN.logInternal(LN.java:600)
	at com.sleepycat.je.tree.LN.log(LN.java:411)
	at com.sleepycat.je.tree.BIN.logDirtyLN(BIN.java:1312)
	at com.sleepycat.je.tree.BIN.logDirtyChildren(BIN.java:1268)
	at com.sleepycat.je.recovery.Checkpointer.logSiblings(Checkpointer.java:1495)
	at com.sleepycat.je.recovery.Checkpointer.flushIN(Checkpointer.java:1243)
	at com.sleepycat.je.recovery.Checkpointer.flushDirtyNodes(Checkpointer.java:1003)
	at com.sleepycat.je.recovery.Checkpointer.syncDatabase(Checkpointer.java:908)
	at com.sleepycat.je.dbi.DatabaseImpl.sync(DatabaseImpl.java:1434)
	at com.sleepycat.je.dbi.DatabaseImpl.handleClosed(DatabaseImpl.java:1302)
	at com.sleepycat.je.Database.closeInternalWork(Database.java:651)
	at com.sleepycat.je.Database.closeInternal(Database.java:518)
	at com.sleepycat.je.Database.close(Database.java:438)
	at com.sleepycat.persist.impl.Store.closeDb(Store.java:1544)
	at com.sleepycat.persist.impl.Store.close(Store.java:1143)
	at com.sleepycat.persist.EntityStore.close(EntityStore.java:667)
	at edu.upenn.cis455.storage.URLQueueDA.close(URLQueueDA.java:116)
	at edu.upenn.cis455.storage.DBWrapper.closeDBs(DBWrapper.java:46)
	at edu.upenn.cis455.crawler.CrawlerWorkerPool.shutdown(CrawlerWorkerPool.java:74)
	at edu.upenn.cis455.servlet.CrawlerServlet.doGet(CrawlerServlet.java:158)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:618)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:725)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:291)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:239)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:106)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:501)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)
	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:610)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:516)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1086)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:659)
	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1558)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1515)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.sleepycat.je.ThreadInterruptedException: Environment invalid because of previous exception: (JE 6.2.31) /home/cis455/workspace/CIS555/Final Proj/database java.lang.InterruptedException THREAD_INTERRUPTED: InterruptedException may cause incorrect internal state, unable to continue. Environment is invalid and must be closed.
	at com.sleepycat.je.latch.SharedLatchImpl.acquireShared(SharedLatchImpl.java:102)
	at com.sleepycat.je.tree.IN.latchShared(IN.java:500)
	at com.sleepycat.je.tree.Tree.getRootINRootAlreadyLatched(Tree.java:460)
	at com.sleepycat.je.tree.Tree.getRootINInternal(Tree.java:438)
	at com.sleepycat.je.tree.Tree.getRootIN(Tree.java:420)
	at com.sleepycat.je.tree.Tree.search(Tree.java:2233)
	at com.sleepycat.je.tree.Tree.search(Tree.java:2200)
	at com.sleepycat.je.dbi.CursorImpl.searchExact(CursorImpl.java:1773)
	at com.sleepycat.je.Cursor.searchExact(Cursor.java:3630)
	at com.sleepycat.je.Cursor.searchNoDups(Cursor.java:3495)
	at com.sleepycat.je.Cursor.search(Cursor.java:3316)
	at com.sleepycat.je.Database.get(Database.java:1400)
	at com.sleepycat.persist.BasicIndex.contains(BasicIndex.java:95)
	at com.sleepycat.persist.PrimaryIndex.contains(PrimaryIndex.java:208)
	at com.sleepycat.persist.BasicIndex.contains(BasicIndex.java:85)
	at com.sleepycat.persist.PrimaryIndex.contains(PrimaryIndex.java:208)
	at edu.upenn.cis455.storage.URLVisitedDA.containsEntry(URLVisitedDA.java:51)
	at edu.upenn.cis455.crawler.CrawlerWorker.extractURL(CrawlerWorker.java:335)
	at edu.upenn.cis455.crawler.CrawlerWorker.crawlPage(CrawlerWorker.java:301)
	at edu.upenn.cis455.crawler.CrawlerWorker.run(CrawlerWorker.java:126)
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1325)
	at java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.tryLock(ReentrantReadWriteLock.java:873)
	at com.sleepycat.je.latch.SharedLatchImpl.acquireShared(SharedLatchImpl.java:97)
	... 19 more

